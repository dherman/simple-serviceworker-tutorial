<!DOCTYPE html>
<html>
  <head>
    <title>Demo of Cross-Origin Script Injection</title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <h1>Demo of Cross-Origin Script Injection</h1>

    <p>If I've got this right, I believe this page demonstrates that ServiceWorkers can see the request URL of (non-CORS) cross-origin scripts, even ones transitively injected by other cross-origin scripts.</p>

    <!-- install some functions loaded locally -->
    <script src="script.js"></script>

    <!-- register the service worker -->
    <script>
      navigator.serviceWorker.register('sw.js', { scope: './' });
      console.log(navigator.serviceWorker.controller);
      setupChannel()
        .then(data => {
          var p = document.createElement('p');
          p.innerHTML = "<b>Service Worker:</b> " + data;
          document.body.appendChild(p);
        })
        .catch(console.log.bind(console));
    </script>

    <!-- some stuff from jake's tutorial, not relevant I think -->
    <script src="logging.js"></script>

    <!-- now load the remote source code -->
    <script src="https://xoscript.surge.sh/foreign-module.js"></script>

  </body>
</html>
